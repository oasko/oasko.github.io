# 识别现象

第1个环节要求我们通过系统运行状态、安全设备告警，发现主机异常现象，以及确认病毒的可疑行为。

## 系统CPU是否异常
枚举进程，CPU降序排序：top
CPU占用率超过70%且名字比较可疑的进程，大概率就是挖矿病毒了。
是否存在可疑进程

枚举进程命令行：ps -aux
病毒一般都携带可疑的命令行，当你发现命令行中带有url等奇怪的字符串时，就要注意了，它很可能是个病毒downloader

安全网关有无报警
从安全网关报警中识别出威胁是最直接，但确认主机已经感染了病毒只是第一步，接下来得定位，具体是哪个进程在与C&C通信。

监控与目标IP通信的进程：
while true; do netstat -antp | grep [ip]; done

有时安全网关检测到的不全是恶意IP，还有可能是个域名，这种情况下，域名对应的IP是变化的，我们不能直接用上述方法进行监控。

我们可以先在host文件中添加一条规则，将恶意域名重定向到一个随机的IP地址，然后对其进行监控。

这样就能得到与之通信的恶意进程了。
有无可疑历史命令
遍历主机历史命令，查找有无恶意命令：history

## 清除病毒
从第1个环节追溯到的进程信息，将会帮助我们定位到病毒进程&病毒文件，实现清除。

结束病毒进程
清除可疑进程的进程链：
ps -elf | grep [pid] kill -9 [pid]

删除病毒文件
定位病毒进程对应的文件路径：
ls -al /proc/[pid]/exe rm -f [exe_path]


